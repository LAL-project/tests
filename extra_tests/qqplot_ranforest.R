make.qqplot <- function(tree_dist, N) {
	main.title = paste0("n=", N)
	
	qqnorm(tree_dist, main = main.title)
	qqline(tree_dist, col=2)
	
	#n = length(tree_dist)
	#cum_tree_dist = mapply(function(j) { sum(tree_dist[1:j]) }, seq(1,n)  )
	#plot(cum_tree_dist, type="o", col="red", ylab="cumul. prob.", xlab="tree", main=main.title)
}

plot.cat.prop <- function(the.prop, emp.prop) {
	num = length(emp.prop)
	n = 4:(4+num-1)
	print(n)
	
	D = abs(emp.prop/the.prop)
	plot(n, D, col = "blue", xlab = "vertices", ylab = "%")
	lines(n, D, col = "blue")
	abline(h = 1)
	
	plot(n, emp.prop, col = "red", xlab = "vertices", ylab = "%")
	lines(n, emp.prop, col = "red")
	lines(n, the.prop, col = "blue")
	points(n, the.prop, col = "blue")
}

#old_d6 = c(0.04912, 0.0492, 0.05108, 0.28604, 0.27728, 0.28728)
#old_d8 = c(0.00914, 0.0084, 0.00842, 0.00882, 0.00888, 0.00906, 0.06928, 0.00926, 0.06944, 0.07198, 0.06948, 0.07046, 0.0087, 0.00872, 0.00894, 0.0705, 0.0712, 0.06974, 0.0711, 0.06974, 0.06948, 0.07004, 0.06922)
#old_d10 = c(0.00114, 0.00138, 0.00132, 0.00156, 0.00172, 0.00132, 0.00156, 0.00126, 0.0017, 0.00142, 0.0148, 0.00132, 0.00116, 0.01672, 0.0015, 0.00162, 0.0162, 0.01478, 0.01522, 0.00132, 0.0155, 0.00168, 0.0013, 0.00156, 0.0014, 0.01466, 0.0158, 0.00128, 0.0012, 0.00144, 0.00128, 0.00154, 0.01598, 0.00148, 0.00114, 0.01496, 0.01494, 0.01508, 0.00142, 0.0148, 0.01486, 0.01432, 0.0149, 0.01438, 0.01406, 0.00138, 0.0013, 0.00144, 0.00134, 0.0014, 0.0157, 0.00136, 0.00138, 0.00134, 0.00126, 0.00144, 0.0014, 0.0145, 0.01498, 0.0155, 0.00108, 0.01568, 0.01558, 0.01556, 0.0154, 0.01472, 0.01516, 0.01542, 0.01582, 0.01544, 0.0158, 0.00108, 0.01536, 0.0156, 0.01678, 0.0148, 0.016, 0.0153, 0.01446, 0.01618, 0.01514, 0.01538, 0.0153, 0.00124, 0.0015, 0.00118, 0.00132, 0.00158, 0.016, 0.0157, 0.0154, 0.01536, 0.01622, 0.0157, 0.01552, 0.0154, 0.01618, 0.01572, 0.0153, 0.01556, 0.01606, 0.01518, 0.01486, 0.01562, 0.0149, 0.01576)


d4 = c(0.49937, 0.50063)
the.cat4 = 1
emp.cat4 = 1

d5 = c(0.33307, 0.3347, 0.33223)
the.cat5 = 1
emp.cat5 = 1

d6 = c(0.16651, 0.16483, 0.16881, 0.16795, 0.16688, 0.16502)
the.cat6 = 1
emp.cat6 = 1

d7 = c(0.09311, 0.09002, 0.08796, 0.09149, 0.09228, 0.09038, 0.09057, 0.09114, 0.08997, 0.09342, 0.08966)
the.cat7 = 0.90909091
emp.cat7 = 0.90783000

d8 = c(0.04387, 0.04233, 0.04546, 0.04309, 0.04263, 0.04365, 0.04338, 0.04282, 0.0448, 0.04325, 0.04311, 0.04344, 0.04414, 0.04308, 0.04328, 0.044, 0.04406, 0.04361, 0.04266, 0.04342, 0.04391, 0.04295, 0.04306)
the.cat8 = 0.86956522
emp.cat8 = 0.86958000

d9 = c(0.02162, 0.0216, 0.02153, 0.02068, 0.02117, 0.02127, 0.02128, 0.02103, 0.02179, 0.02111, 0.0213, 0.02184, 0.02107, 0.02139, 0.02085, 0.02128, 0.02086, 0.01999, 0.02147, 0.02045, 0.02126, 0.02158, 0.02204, 0.02157, 0.02102, 0.0211, 0.02157, 0.02158, 0.02141, 0.02148, 0.02127, 0.02063, 0.0211, 0.0214, 0.02098, 0.02065, 0.02108, 0.02125, 0.0215, 0.02126, 0.02094, 0.02114, 0.02168, 0.02186, 0.02244, 0.02177, 0.02086)
the.cat9 = 0.7659574468085106
emp.cat9 = 0.76415

d10 = c(0.00906, 0.00953, 0.00972, 0.01005, 0.0094, 0.00977, 0.00954, 0.00969, 0.00885, 0.00946, 0.009, 0.00941, 0.00961, 0.00929, 0.00929, 0.00912, 0.00929, 0.0097, 0.00934, 0.00941, 0.0094, 0.00939, 0.00975, 0.00904, 0.01003, 0.00958, 0.00931, 0.0096, 0.00924, 0.00921, 0.00937, 0.00955, 0.00943, 0.00904, 0.00935, 0.00961, 0.00927, 0.00964, 0.00965, 0.00919, 0.00971, 0.00902, 0.0097, 0.00933, 0.00926, 0.00951, 0.0097, 0.00972, 0.00918, 0.00967, 0.0091, 0.00985, 0.00949, 0.00921, 0.00985, 0.00954, 0.00943, 0.00922, 0.00937, 0.00916, 0.00938, 0.00949, 0.00884, 0.00978, 0.00921, 0.00965, 0.00912, 0.0094, 0.0093, 0.00887, 0.00909, 0.00905, 0.00927, 0.0095, 0.00991, 0.00927, 0.00874, 0.00929, 0.00966, 0.00978, 0.01001, 0.00945, 0.00997, 0.00994, 0.01002, 0.00979, 0.00942, 0.00974, 0.00997, 0.00894, 0.00914, 0.00976, 0.00962, 0.00957, 0.00961, 0.00913, 0.00932, 0.00919, 0.00933, 0.00938, 0.00953, 0.00987, 0.00918, 0.00919, 0.00869, 0.00944)
the.cat10 = 0.6792452830188679
emp.cat10 = 0.67938

d11 = c(0.00411, 0.00421, 0.00404, 0.00418, 0.00447, 0.00441, 0.00446, 0.00446, 0.00435, 0.00395, 0.00458, 0.00435, 0.00427, 0.00411, 0.00425, 0.00433, 0.00409, 0.00439, 0.00431, 0.00423, 0.00418, 0.00445, 0.00422, 0.00407, 0.00444, 0.00428, 0.00383, 0.00414, 0.0041, 0.00423, 0.00397, 0.00437, 0.00413, 0.00408, 0.00391, 0.00446, 0.00452, 0.00413, 0.00419, 0.0047, 0.00397, 0.00442, 0.00443, 0.00407, 0.00437, 0.0041, 0.00411, 0.00445, 0.00383, 0.00399, 0.00448, 0.00423, 0.00405, 0.00459, 0.00445, 0.00444, 0.00441, 0.00416, 0.004, 0.00401, 0.00431, 0.00405, 0.00404, 0.00422, 0.00467, 0.00405, 0.00434, 0.00431, 0.0044, 0.00418, 0.00451, 0.00475, 0.00404, 0.00442, 0.00438, 0.00431, 0.00407, 0.00449, 0.004, 0.00414, 0.00445, 0.00417, 0.00459, 0.00416, 0.00422, 0.00452, 0.00416, 0.00427, 0.00426, 0.00426, 0.00403, 0.00401, 0.00461, 0.0041, 0.00416, 0.00432, 0.00426, 0.00444, 0.00407, 0.00408, 0.00413, 0.00435, 0.00422, 0.004, 0.00414, 0.00411, 0.0048, 0.00398, 0.00443, 0.00426, 0.00398, 0.00436, 0.00405, 0.00419, 0.00406, 0.00474, 0.00433, 0.00405, 0.00399, 0.00447, 0.00436, 0.00406, 0.00416, 0.00419, 0.0043, 0.00421, 0.00417, 0.00438, 0.00424, 0.00449, 0.00421, 0.00396, 0.00427, 0.0044, 0.00439, 0.00417, 0.0043, 0.00414, 0.00459, 0.00484, 0.0046, 0.004, 0.00428, 0.00413, 0.00397, 0.004, 0.00416, 0.00418, 0.00402, 0.00428, 0.00465, 0.00439, 0.0039, 0.00433, 0.00387, 0.00472, 0.00393, 0.00415, 0.00403, 0.00413, 0.004, 0.00413, 0.00432, 0.00468, 0.00458, 0.00391, 0.00384, 0.00427, 0.00413, 0.00379, 0.00435, 0.0044, 0.00425, 0.00434, 0.00413, 0.00468, 0.00465, 0.00405, 0.00403, 0.00424, 0.00408, 0.00417, 0.00404, 0.00465, 0.00398, 0.00416, 0.00432, 0.00457, 0.00455, 0.0046, 0.00414, 0.00427, 0.00435, 0.00421, 0.00401, 0.00408, 0.00439, 0.00408, 0.00411, 0.00455, 0.00428, 0.00386, 0.00429, 0.00452, 0.00397, 0.00428, 0.00428, 0.00458, 0.00396, 0.00468, 0.0042, 0.00436, 0.00422, 0.0042, 0.00425, 0.00454, 0.00452, 0.00423, 0.00399, 0.00443, 0.00418, 0.00436, 0.00423, 0.0041, 0.00419, 0.00475, 0.00434, 0.00407, 0.00445, 0.00426, 0.00432, 0.00423, 0.00445, 0.0046, 0.00423)
the.cat11 = 0.5787234042553191
emp.cat11 = 0.57861

d12 = c(0.00168, 0.00187, 0.0017, 0.0018, 0.00187, 0.00173, 0.00175, 0.00173, 0.00193, 0.00168, 0.002, 0.00175, 0.00193, 0.00186, 0.00163, 0.00182, 0.00185, 0.00179, 0.00175, 0.00187, 0.00194, 0.00182, 0.00174, 0.00193, 0.00175, 0.00184, 0.00193, 0.00175, 0.00193, 0.00161, 0.00179, 0.00195, 0.00169, 0.00181, 0.00184, 0.00173, 0.00166, 0.00187, 0.00181, 0.00151, 0.00177, 0.00184, 0.00197, 0.00193, 0.00172, 0.00217, 0.00164, 0.00194, 0.00175, 0.00201, 0.00203, 0.00195, 0.00175, 0.00176, 0.00189, 0.00166, 0.00151, 0.0016, 0.00179, 0.00176, 0.00235, 0.00175, 0.00179, 0.00177, 0.00184, 0.0019, 0.00194, 0.00179, 0.00164, 0.00168, 0.00167, 0.00211, 0.00193, 0.00183, 0.00189, 0.00165, 0.00208, 0.00181, 0.00196, 0.00192, 0.00198, 0.00196, 0.00176, 0.00185, 0.00195, 0.00184, 0.00184, 0.00148, 0.00192, 0.00167, 0.00179, 0.00177, 0.00182, 0.0019, 0.00225, 0.00192, 0.00163, 0.00168, 0.00208, 0.00174, 0.00178, 0.00205, 0.00197, 0.00201, 0.00199, 0.0017, 0.00187, 0.00181, 0.00206, 0.00193, 0.00181, 0.00186, 0.00158, 0.00166, 0.00203, 0.00149, 0.00174, 0.00192, 0.00198, 0.00192, 0.00174, 0.00163, 0.00158, 0.00177, 0.00183, 0.00175, 0.0016, 0.00204, 0.00201, 0.00179, 0.00163, 0.00186, 0.00184, 0.00176, 0.0019, 0.00185, 0.0017, 0.00188, 0.00188, 0.00174, 0.00199, 0.0021, 0.00179, 0.00175, 0.00182, 0.00178, 0.0017, 0.00176, 0.00213, 0.00166, 0.00181, 0.00172, 0.00189, 0.002, 0.00179, 0.0017, 0.00176, 0.00192, 0.00169, 0.00178, 0.00195, 0.00173, 0.00185, 0.00154, 0.0017, 0.00192, 0.00189, 0.00212, 0.00198, 0.0018, 0.00174, 0.00181, 0.00153, 0.00187, 0.00177, 0.00187, 0.00185, 0.00172, 0.0018, 0.00171, 0.002, 0.00181, 0.00186, 0.0019, 0.00178, 0.00178, 0.00188, 0.00188, 0.00157, 0.00173, 0.00184, 0.00177, 0.00188, 0.00177, 0.00167, 0.00172, 0.00168, 0.00166, 0.00169, 0.00184, 0.00184, 0.00171, 0.00197, 0.00181, 0.00191, 0.00175, 0.00191, 0.00191, 0.00173, 0.00169, 0.00192, 0.00192, 0.00188, 0.00178, 0.0017, 0.00184, 0.00178, 0.00171, 0.00185, 0.00185, 0.00152, 0.00191, 0.00164, 0.00173, 0.00186, 0.00171, 0.00193, 0.00183, 0.00167, 0.002, 0.00179, 0.00183, 0.00175, 0.00176, 0.0018, 0.0018, 0.00184, 0.00158, 0.00183, 0.00175, 0.00176, 0.00193, 0.00171, 0.00159, 0.00185, 0.00169, 0.00166, 0.0018, 0.00176, 0.00165, 0.002, 0.00184, 0.00161, 0.00163, 0.00194, 0.00191, 0.00162, 0.00184, 0.00186, 0.00151, 0.00189, 0.00202, 0.00148, 0.00145, 0.00168, 0.00162, 0.00197, 0.00191, 0.00181, 0.00176, 0.00175, 0.00184, 0.00179, 0.00202, 0.00187, 0.00191, 0.00152, 0.00215, 0.0019, 0.00176, 0.00173, 0.00173, 0.00173, 0.00177, 0.00184, 0.00191, 0.0017, 0.00177, 0.0016, 0.00195, 0.00174, 0.00185, 0.00185, 0.00197, 0.00188, 0.00179, 0.00188, 0.00177, 0.00172, 0.00211, 0.00158, 0.00214, 0.00181, 0.00209, 0.00185, 0.00173, 0.00181, 0.00175, 0.00155, 0.00184, 0.00191, 0.00196, 0.00193, 0.00191, 0.00188, 0.00168, 0.00204, 0.00181, 0.0017, 0.00197, 0.00184, 0.00199, 0.00193, 0.00174, 0.00177, 0.00182, 0.00184, 0.00196, 0.00192, 0.00168, 0.00167, 0.00177, 0.00175, 0.00177, 0.00174, 0.0017, 0.00207, 0.00169, 0.00186, 0.0018, 0.002, 0.00185, 0.00202, 0.00166, 0.00181, 0.00183, 0.00176, 0.00184, 0.00188, 0.00188, 0.00194, 0.002, 0.00188, 0.00184, 0.00189, 0.00176, 0.00178, 0.00198, 0.00175, 0.00175, 0.00189, 0.00166, 0.00203, 0.00196, 0.00159, 0.00188, 0.00177, 0.0017, 0.00174, 0.00205, 0.00191, 0.00162, 0.00172, 0.00186, 0.00171, 0.00187, 0.00194, 0.00174, 0.00214, 0.00178, 0.00169, 0.00198, 0.00171, 0.00196, 0.00196, 0.00185, 0.00193, 0.00169, 0.00171, 0.00194, 0.00162, 0.00188, 0.00165, 0.00173, 0.00191, 0.00174, 0.0017, 0.00185, 0.00204, 0.0019, 0.00166, 0.00193, 0.00181, 0.00162, 0.00196, 0.00193, 0.00198, 0.00183, 0.00176, 0.00203, 0.00166, 0.00192, 0.00178, 0.00171, 0.00194, 0.00202, 0.00173, 0.00187, 0.00184, 0.00184, 0.00172, 0.00177, 0.0017, 0.00158, 0.00182, 0.00173, 0.00186, 0.00172, 0.00152, 0.00203, 0.00146, 0.00171, 0.00182, 0.00182, 0.00172, 0.00188, 0.0015, 0.00171, 0.00168, 0.00186, 0.00186, 0.00195, 0.0018, 0.00198, 0.00178, 0.00192, 0.00191, 0.00167, 0.00175, 0.00188, 0.0017, 0.00183, 0.0017, 0.00186, 0.00167, 0.00184, 0.00152, 0.00175, 0.00186, 0.00183, 0.00188, 0.00175, 0.00186, 0.00187, 0.00165, 0.00207, 0.00188, 0.00196, 0.00193, 0.00194, 0.00161, 0.00172, 0.00181, 0.00187, 0.00198, 0.00172, 0.00179, 0.00202, 0.00195, 0.00178, 0.00184, 0.00157, 0.00196, 0.00177, 0.00185, 0.00194, 0.00161, 0.00182, 0.00184, 0.00192, 0.0018, 0.00183, 0.00166, 0.00191, 0.0019, 0.00182, 0.00168, 0.00201, 0.00186, 0.00196, 0.00171, 0.00177, 0.00171, 0.00167, 0.00182, 0.0019, 0.00179, 0.00197, 0.00194, 0.00172, 0.00212, 0.00171, 0.00177, 0.00197, 0.00204, 0.002, 0.00172, 0.00193, 0.00182, 0.00178, 0.00191, 0.00161, 0.00164, 0.00165, 0.00205, 0.0018, 0.00166, 0.00185, 0.00205, 0.00186, 0.00201, 0.00175, 0.00162, 0.00189, 0.00176, 0.00182, 0.00183, 0.00181, 0.0019, 0.00169, 0.0017, 0.00169, 0.00182, 0.00181, 0.00176, 0.00169, 0.00178, 0.00188, 0.00165, 0.00175, 0.00168)
the.cat12 = 0.49364791288566245
emp.cat12 = 0.49457

make.qqplot(d6, 6)
make.qqplot(d7, 7)
make.qqplot(d8, 8)
make.qqplot(d9, 9)
make.qqplot(d10, 10)
make.qqplot(d11, 11)
make.qqplot(d12, 12)

the.cat = c(the.cat4, the.cat5, the.cat6, the.cat7, the.cat8, the.cat9, the.cat10, the.cat11, the.cat12)
emp.cat = c(emp.cat4, emp.cat5, emp.cat6, emp.cat7, emp.cat8, emp.cat9, emp.cat10, emp.cat11, emp.cat12)
plot.cat.prop(the.cat, emp.cat)